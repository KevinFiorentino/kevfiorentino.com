---
import { getCollection } from 'astro:content';
import { collectionMetadata } from '@content/config';
import { languages } from '@i18n/ui';
import MainLayout from '@layouts/MainLayout.astro';

export async function getStaticPaths() {

  const pages: any[] = [];

  // Build pages of each content
  for await (let c of collectionMetadata) {
    const coll = await getCollection(c.name as any);
    coll.map((post) => {
      Object.keys(languages).map((l: string) => {
        pages.push({
          params: {
            lang: l,
            category: c.name,
            slug: post.slug.slice(3)    // Remove /{lang}
          },
          props: {
            category: c.name,
            post: post,
          },
        })
      });
    });
  }

  return pages;
}

const param = Astro.params;
const post = Astro.props.post;

const { Content } = await post.render();
---

<MainLayout
  title={`${post.data.title} | Kevin Fiorentino`}
  description={`${post.data.desc}`}
>
  <Content />
</MainLayout>
