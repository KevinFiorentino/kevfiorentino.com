---
import { getCollection } from 'astro:content';
import { collectionMetadata } from '@content/config';
import { languages } from '@i18n/ui';
import MainLayout from '@layouts/MainLayout.astro';
import ArticleLayout from '@layouts/ArticleLayout.astro';
import Breadcrumbs from '@components/Breadcrumbs.astro';
import DisplayTagsDate from '@components/DisplayTagsDate.astro';

export async function getStaticPaths() {

  const pages: any[] = [];

  // Build pages of each content
  for await (let c of collectionMetadata) {
    const coll = await getCollection(c.name as any);
    coll.map((post) => {
      pages.push({
        params: {
          lang: post.slug.split('/')[0],
          category: c.name,
          slug: post.slug.slice(3),
        },
        props: {
          category: c.name,
          post: post,
        },
      });
    });
  }

  return pages;
}

const param = Astro.params;
const post = Astro.props.post;

const { collection } = post;
const { title, description, image, tags, pubDate } = post.data;
const { Content } = await post.render();
---

<MainLayout
  title={`${title} | Kevin Fiorentino`}
  description={`${description}`}
  image=''
>
  <ArticleLayout>
    <Breadcrumbs
      collection={collection}
    ></Breadcrumbs>
    <DisplayTagsDate
      tags={tags}
      pubDate={pubDate}
    ></DisplayTagsDate>
    <Content />
  </ArticleLayout>
</MainLayout>
